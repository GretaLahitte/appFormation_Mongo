<h1>{{title}}</h1>
<form methode="POST" action="{{form_action}}" id="formAddCenter">
    <input type="hidden" name="id" value="{{centre._id}}" />
    <input  type="hidden" name="lat" id="lat" value="{{centre.lat}}" />
    <input  type="hidden" name="lon" id="lon" value="{{centre.lon}}"/>
    Nom : <input type="text" name="nom" value="{{centre.nom}}" /><br/>
    Adresse : <input type="text" name="adresse" value="{{centre.adresse}}" /><br/>
    cp : <input type="text" name="cp" value="{{centre.cp}}" /><br/>
    city : <input type="text" name="city" value="{{centre.city}}" /><br/>
    home_phone : <input type="text" name="home_phone" value="{{centre.home_phone}}" /><br/>
    mail : <input type="text" name="mail" value="{{centre.mail}}" /><br/>
        <input type="submit" value="Confirmer la {{libelle}}" />

</form>
<!-- Script de validation du formulaire de modification -->
<script>
    var form = document.getElementById('formAddCenter');
    console.log(form.action);
    form.addEventListener('submit', function(evt) {
        form.action += "/{{centre._id}}";
        form.submit();
    });
  var addr=form.adresse.value;
  addr=addr.toLowerCase()
  addr = addr.split(' ').join('+');
  var city=form.city.value;
  city=city.toLowerCase()
  city=city.split(' ').join('+');
  var info=addr+','+city;
    console.log(info);
</script>


<script>
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        myFunction(this);
    }
};
xhttp.open("GET", "http://nominatim.openstreetmap.org/search?q="+info+"&format=json&polygon=1&addressdetails=1", true);
xhttp.send();

function myFunction(json) {
    var jsonDoc = JSON.parse(json.responseText);
    console.log(jsonDoc[0].lat);
    console.log(jsonDoc[0].lon);
    var lat=Number(jsonDoc[0].lat);
    var lon=Number(jsonDoc[0].lon);

    document.getElementById('lat').value=lat;
    document.getElementById('lon').value=lon;
}
</script>
