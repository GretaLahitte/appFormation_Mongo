<h1>{{title}}</h1>
<form methode="POST" action="{{form_action}}" id="formAddUser">
    <input type="hidden" name="id" value="{{user._id}}" />
    <input  type="hidden" name="lat" id="lat" value="{{user.lat}}" />
    <input  type="hidden" name="lon" id="lon" value="{{user.lon}}"/>
    name : <input type="text" name="name" value="{{user.name}}" /><br/>
    firstName : <input type="text" name="firstName" value="{{user.firstName}}" /><br/>
    login : <input type="text" name="login" value="{{user.login}}" /><br/>
    mdp : <input type="password" name="mdp" value="{{user.mdp}}" /><br/>
    function : <input type="text" name="function" value="{{user.function}}" /><br/>
    office : <input type="text" name="office" value="{{user.office}}" /><br/>
    date_naiss : <input type="text" name="date_naiss" value="{{user.date_naiss}}" /><br/>
    mail : <input type="text" name="mail" value="{{user.mail}}" /><br/>
    adresse : <input type="text" name="adresse" value="{{user.adresse}}" /><br/>
    cp : <input type="text" name="cp" value="{{user.cp}}" /><br/>
    city : <input type="text" name="city" value="{{user.city}}" /><br/>
    mobile_phone : <input type="text" name="mobile_phone" value="{{user.mobil_phone}}" /><br/>
    home_phone : <input type="text" name="home_phone" value="{{user.home_phone}}" /><br/>
    <button type="submit" disabled id="submit">Confirmer la {{libelle}}</button>
</form>
<!-- Script de validation du formulaire de modification -->
<script>
    var form = document.getElementById('formAddUser');
    form.addEventListener('submit', function(evt) {
        form.action += "/{{user._id}}";
        form.submit();
    });
  var addr=form.adresse.value;
  addr=addr.toLowerCase()
  addr = addr.split(' ').join('+');
  var city=form.city.value;
  city=city.toLowerCase()
  city=city.split(' ').join('+');
  var info=addr+','+city;
    console.log(info);
</script>


<script>
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        myFunction(this);
    }
};
xhttp.open("GET", "http://nominatim.openstreetmap.org/search?q="+info+"&format=json&polygon=1&addressdetails=1", true);
xhttp.send();

function myFunction(json) {
	document.getElementById("submit").disabled=false;
    var jsonDoc = JSON.parse(json.responseText);
    console.log(jsonDoc[0].lat);
    console.log(jsonDoc[0].lon);
    var lat=Number(jsonDoc[0].lat);
    var lon=Number(jsonDoc[0].lon);

    document.getElementById('lat').value=lat;
    document.getElementById('lon').value=lon;
}
</script>
